<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">

    <title>Alangasar</title>
    <meta name="title" content="Alangasar"/>
    <meta name="description" content="Flutter Developer creating beautiful cross-platform apps. Home Assistant enthusiast."/>

    <meta property="og:site_name" content="Alangasar"/>
    <meta property="og:title" content="Alangasar">
    <meta property="og:description" content="Flutter Developer creating beautiful cross-platform apps. Home Assistant enthusiast. Passionate about clean architecture and pixel-perfect UIs.">
    <meta property="og:image" content="https://avatars.githubusercontent.com/u/1198853">
    <meta property="og:url" content="https://alangasar.com">
    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary_large_image" />
    <meta property="twitter:title" content="Alangasar"/>
    <meta property="twitter:description" content="Flutter Developer creating beautiful cross-platform apps. Home Assistant enthusiast. Passionate about clean architecture and pixel-perfect UIs."/>
    <meta property="twitter:image" content="https://avatars.githubusercontent.com/u/1198853"/>
    <meta property="twitter:url" content="https://alangasar.com/" />
</head>
<body>
    <div id="battery-status">
    <i class="fas fa-battery-half"></i>
    <span id="battery-level">--%</span>
    <div id="battery-tooltip" class="tooltip"></div>
</div>
<div class="container">
    <div class="logo">
        <img src="https://avatars.githubusercontent.com/u/1198853" alt="Alangasar">
    </div>

    <h1 class="name">Yura Gushchin</h1>
    <span class="username">@Alangasar</span>
    <p class="bio">Flutter Developer creating beautiful cross-platform apps. <span class="ha-text">Home Assistant</span> enthusiast. Passionate about clean architecture and pixel-perfect UIs.</p>

    <div class="social-links">
        <a href="https://t.me/protractora" class="social-link" aria-label="Telegram"><i class="fab fa-telegram"></i></a>
        <a href="https://github.com/alangasar" class="social-link" aria-label="GitHub"><i class="fab fa-github"></i></a>
    </div>

    <footer>
        &copy; <script>document.write(new Date().getFullYear())</script> Yura Gushchin. All rights reserved.<br>
        <small>Website generated by AI.</small>
    </footer>
</div>
<script>
document.addEventListener("DOMContentLoaded", function () {

    const statusElement = document.getElementById('battery-status');
    const tooltip = document.getElementById('battery-tooltip');
    const batteryIcon = document.querySelector('#battery-status i');
    const batteryLevelSpan = document.getElementById('battery-level');

    function updateBatteryDisplay(level) {

        batteryLevelSpan.textContent = `${level}%`;

        if (level > 75) {
            batteryIcon.className = 'fas fa-battery-full';
        } else if (level > 50) {
            batteryIcon.className = 'fas fa-battery-three-quarters';
        } else if (level > 25) {
            batteryIcon.className = 'fas fa-battery-half';
        } else if (level > 10) {
            batteryIcon.className = 'fas fa-battery-quarter';
        } else {
            batteryIcon.className = 'fas fa-battery-empty';
            batteryIcon.style.color = 'var(--secondary)';
        }
    }

    // === ТУЛТИП ===

    function showTooltip() {
        tooltip.classList.add('visible');
    }

    function hideTooltip() {
        tooltip.classList.remove('visible');
    }

    // ПК (hover)
    statusElement.addEventListener('mouseenter', showTooltip);
    statusElement.addEventListener('mouseleave', hideTooltip);

    // Телефон (tap)
    statusElement.addEventListener('click', function (e) {
        e.stopPropagation();
        tooltip.classList.toggle('visible');
    });

    // Закрытие при клике вне
    document.addEventListener('click', hideTooltip);

    // === Загрузка JSON ===

    fetch('battery.json?nocache=' + new Date().getTime(), {
        cache: 'no-store'
    })
    .then(response => {
        if (!response.ok) {
            statusElement.style.display = 'none';
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {

        // если вдруг прилетела строка
        if (typeof data === "string") {
            data = JSON.parse(data);
        }

        if (data && typeof data.battery === 'number' && data.updated) {

            updateBatteryDisplay(data.battery);

            const updatedTime = new Date(data.updated);
            const readableTime = updatedTime.toLocaleString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            });

            tooltip.innerHTML = `
                Current battery level of my phone.<br>
                Automatically updated from Home Assistant.<br><br>
                Last update:<br>
                ${readableTime}
            `;
        }

    })
    .catch(error => {
        console.error('Battery fetch error:', error);
    });

});
</script>

</body>
</html>
